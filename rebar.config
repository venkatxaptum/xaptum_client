{erl_opts, [debug_info, {lager_extra_sinks, [log]},{parse_transform, lager_transform}]}.

{deps, [
	{erltls, ".*", {git, "https://github.com/xaptum-eng/erltls", {branch, "master"}}},
	{bacnet_utils, ".*", {git, "https://github.com/venkat-xaptum/bacnet-utils-erl", {branch, "master"}}},
	{lager, ".*", {git, "https://github.com/erlang-lager/lager", {branch, "master"}}},
	{enacl, ".*", {git, "https://github.com/xaptum/enacl", {branch, "master"}}},
	{recon, ".*", {git, "https://github.com/ferd/recon.git", {branch, "master"}}},
	{folsom, ".*", {git, "https://github.com/boundary/folsom.git", {branch, "master"}}},
	{oneup, ".*", {git, "https://github.com/andytill/oneup.git", {branch, "master"}}},
	{elli, "3.0.0"}
]}.

{pre_hooks,
  [{"(linux|darwin|solaris)", compile, "make -C c_src"},
   {"(freebsd)", compile, "gmake -C c_src"}]}.
{post_hooks,
  [{"(linux|darwin|solaris)", clean, "make -C c_src clean"},
   {"(freebsd)", clean, "gmake -C c_src clean"}]}.

{cover_enabled, true}.

%% xref configurations
{xref_checks,[undefined_function_calls,undefined_functions,              
	      deprecated_function_calls, deprecated_functions]}.

{relx, [{release, {enfddsc, "1.0"},
  ['enfddsc']},

  {dev_mode, true},
  {include_erts, true},
  {system_libs, false},

  {overlay_vars, "./templates/vars.config"},
  {overlay, [
    {template, "./templates/sys.config", "releases/{{default_release_version}}/sys.config"},
    {template, "./templates/vm.args", "releases/{{default_release_version}}/vm.args"}
  ]},
  {extended_start_script, true}]
}.

{profiles, [
  {test, [{deps, [
    {meck, ".*",
      {git, "https://github.com/eproxus/meck.git", {tag, "0.8.3"}}}
  ]},
    {relx, [{overlay_vars, ["./templates/vars.config", "./templates/vars_test.config"]}]}
  ]},
  {device, [{relx, [{dev_mode, false}, {include_erts, true}, {include_src, false},
    {overlay_vars, ["./templates/vars.config", "./templates/vars_device.config"]}]}]},
  {subscriber, [{relx, [{dev_mode, false}, {include_erts, true}, {include_src, false},
    {overlay_vars, ["./templates/vars.config", "./templates/vars_subscriber.config"]}]}]},
  {gateway, [{relx, [{dev_mode, false}, {include_erts, true}, {include_src, false},
    {overlay_vars, ["./templates/vars.config", "./templates/vars_gateway.config"]}]}]}
]}.
